================================================================================
                    NETSTAT COMMAND CHEAT SHEET
                 Network Monitoring for System Admins
================================================================================

üìå WHAT IS NETSTAT?
   A command-line network utility tool for monitoring:
   ‚Ä¢ Active network connections
   ‚Ä¢ Routing tables
   ‚Ä¢ Network interfaces
   ‚Ä¢ Protocol statistics

‚ö†Ô∏è  IMPORTANT FOR MAC USERS:
   ‚Ä¢ netstat works but may be slower on newer macOS versions
   ‚Ä¢ Alternative: lsof -i -P (shows programs using your internet)
   ‚Ä¢ Remember: flags need a command! Use "netstat -a" not just "-a"

================================================================================
                        1. BASIC FLAG REFERENCE
================================================================================

Think of flags as "instructions" you attach to the netstat command.
You can COMBINE them (e.g., netstat -atp)

FLAG    WHAT IT DOES
----    ------------------------------------------------------------
-a      ALL connections (active + listening)
-t      TCP only (Transmission Control Protocol)
-u      UDP only (User Datagram Protocol - connectionless)
-n      NUMERIC addresses (shows IPs instead of names - faster!)
-p      PROGRAM/Process ID (which app is using this connection)
-l      LISTENING ports only (services waiting for connections)
-r      ROUTING table (shows where packets go)
-i/-ie  INTERFACES (network cards info)
-c      CONTINUOUS output (live feed until you stop it)
-s      STATISTICS for each protocol

================================================================================
                    2. ESSENTIAL COMMANDS YOU'LL USE
================================================================================

üîπ VIEW NETWORK INTERFACES (like ifconfig)
   netstat -ie
   ‚Üí Shows all your network cards (Ethernet, Wi-Fi, Loopback)

üîπ SEE ROUTING TABLE (where does your internet go?)
   netstat -r
   ‚Üí Shows Gateway (usually your router like 192.168.1.1)

üîπ LIVE MONITORING (real-time connections)
   netstat -c
   ‚Üí Keeps updating until you press Ctrl+C

üîπ ALL CONNECTIONS (active + listening)
   netstat -a
   ‚Üí Everything your computer is doing network-wise

================================================================================
                   3. FILTERING BY PROTOCOL (TCP vs UDP)
================================================================================

üîπ TCP CONNECTIONS ONLY
   netstat -at
   ‚Üí Shows only TCP traffic (web browsing, SSH, etc.)

üîπ UDP CONNECTIONS ONLY
   netstat -au
   ‚Üí Shows UDP traffic (DNS, video streaming, gaming)
   ‚Üí Note: UDP has no "state" because it's connectionless

üîπ NUMERIC TCP CONNECTIONS (fastest)
   netstat -nt
   ‚Üí Shows active TCP connections with IP addresses

================================================================================
                  4. FINDING LISTENING SERVICES
================================================================================

These commands show "open doors" waiting for someone to connect:

üîπ LISTENING TCP PORTS
   netstat -lt
   ‚Üí Shows services in LISTEN state (web servers, SSH, etc.)

üîπ LISTENING UDP PORTS
   netstat -lu
   ‚Üí Shows active UDP services

üîπ ALL LISTENING PORTS (numeric, fast)
   netstat -ltn
   ‚Üí Perfect for checking if your server is running on port 8080!

üîπ MAC-SPECIFIC LISTENING PORTS
   netstat -anL
   ‚Üí Better for macOS

================================================================================
                   5. IDENTIFYING PROGRAMS/PROCESSES
================================================================================

üîπ SHOW WHICH PROGRAM IS USING EACH CONNECTION
   netstat -p
   ‚Üí Adds PID (Process ID) and program name column

üîπ ALL TCP CONNECTIONS WITH PROGRAM NAMES
   netstat -atp
   ‚Üí See which apps (Firefox, SSH, Chrome) are connected

üîπ COMBINED: All info at once
   netstat -tulpn
   ‚Üí TCP + UDP + Listening + Program + Numeric
   ‚Üí (Linux - may need sudo)

================================================================================
                    6. SEARCHING FOR SPECIFIC PORTS
================================================================================

Use "grep" to filter the list:

üîπ FIND PORT 80 (HTTP web traffic)
   netstat -an | grep :80

üîπ CHECK IF SSH IS RUNNING (port 22)
   netstat -nlp | grep 22

üîπ FIND ALL CONNECTIONS TO A SPECIFIC IP
   netstat -an | grep 192.168.1.100

================================================================================
                   7. UNDERSTANDING THE OUTPUT
================================================================================

COLUMN          WHAT IT MEANS
------          -------------
Local Address   Your computer's IP:PORT
Foreign Address Remote server's IP:PORT (who you're talking to)
State           Connection status (see below)

CONNECTION STATES:
------------------
ESTABLISHED     ‚úÖ Active connection, data is flowing
LISTEN          üîä Port is open, waiting for connections
CLOSE_WAIT      ‚è≥ Remote side closed, your side waiting to close
TIME_WAIT       ‚è≤Ô∏è  Connection closed, waiting for late packets
SYN_SENT        üì§ Your computer is trying to connect
SYN_RECEIVED    üì• Someone is trying to connect to you

================================================================================
                    8. PRACTICAL EXERCISES
================================================================================

üìù Try these on your MacBook:

1. See all connections:
   netstat -an

2. Open a web browser, visit any website, then run:
   netstat -nt
   ‚Üí You'll see new ESTABLISHED connections to the website's IP!

3. Check what's listening on your computer:
   netstat -anL

4. Get protocol statistics:
   netstat -s

5. Use the modern alternative:
   lsof -i -P
   ‚Üí Shows which programs are using your internet

================================================================================
                    9. COMMON USE CASES
================================================================================

‚úÖ CHECK IF YOUR SERVER IS RUNNING
   netstat -ltn | grep 8080
   ‚Üí If building a web app on port 8080

‚úÖ FIND SUSPICIOUS CONNECTIONS
   netstat -atp
   ‚Üí See what programs are connected to the internet

‚úÖ DEBUG NETWORK ISSUES
   netstat -r
   ‚Üí Check if your routing table is correct

‚úÖ MONITOR ACTIVE SESSIONS
   netstat -c
   ‚Üí Watch connections in real-time

‚úÖ VERIFY A SERVICE STARTED
   netstat -nlp | grep ssh
   ‚Üí After starting SSH server

================================================================================
                      10. QUICK REFERENCE
================================================================================

Most Used Commands:
-------------------
netstat -an          ‚Üí All connections, numeric
netstat -ltn         ‚Üí Listening TCP ports
netstat -atp         ‚Üí All TCP with program names
netstat -r           ‚Üí Routing table
netstat -s           ‚Üí Statistics
lsof -i -P           ‚Üí Mac alternative (shows programs)

Troubleshooting:
----------------
‚Ä¢ Always use "netstat" first, then the flags
‚Ä¢ On Mac, use -anL for listening ports (not -lt)
‚Ä¢ Add "sudo" before command if you get permission errors
‚Ä¢ Pipe to grep to filter: netstat -an | grep :80

================================================================================
                          STUDY TIPS
================================================================================

1. Start with: netstat -an
   ‚Üí This shows everything, get familiar with the output

2. Learn the states: ESTABLISHED, LISTEN, CLOSE_WAIT
   ‚Üí These tell you what's actually happening

3. Practice filtering: Use -t, -u, -l to narrow down results

4. Combine flags: netstat -tulpn gives you maximum info

5. Use grep: When the list is too long, search for specific ports

================================================================================
Source: HackerSploit YouTube Tutorial
"Netstat Commands - Network Administration Tutorial"
================================================================================